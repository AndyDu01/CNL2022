<script src="lib/js/html5-qrcode.min.js"></script>


<div class="row">
    <div class="col">
        <div style="width:500px;" id="reader"></div>
    </div>
    <div class="col" style="padding:30px;">
        <h4>SCAN RESULT</h4>
        <div id="result">Result Here</div>
    </div>
    <button id="startbutton">Please Wait</button>
</div>


<script type="text/javascript">
    var cameraId = null;
    const width = window.innerWidth;
    const height = window.innerHeight;

    const startbutton = document.getElementById('startbutton');

    Html5Qrcode.getCameras().then(devices => {
        console.log(devices);
        startbutton.innerText = 'Start';
        var flag = true;

        for (i in devices) {
            device = devices[i]
            if (device['label'].toLowerCase().includes('rear') || device['label'].toLowerCase().includes('back')) {
                cameraId = device.id;
                flag = false;
            }
        }
        if (flag) {
            cameraId = devices[0].id;
        }
    }).catch(err => {
        console.log(err);
        console.log('No camera!!');
    });
    startbutton.addEventListener('click', event => {
        if (cameraId == null) {
            return;
        }
        const html5QrCode = new Html5Qrcode("reader", true);
        html5QrCode.start(
            cameraId,
            {
                fps: 10,    // Optional, frame per seconds for qr code scanning
                qrbox: { width: width, height: height }  // Optional, if you want bounded box UI
            },
            (decodedText, decodedResult) => {
                document.getElementById('result').innerHTML = '<span class="result">' + decodedText + " www  " + decodedResult + '</span>';
                html5QrCode.stop().then((ignore) => {
                    alert(decodedText);
                }).catch((err) => {
                    // Stop failed, handle it.
                });
            },
            (errorMessage) => {
                console.log(errorMessage);
            })
            .catch((err) => {
                console.log(err);

            });
    });
        /* Basic usage
function onScanSuccess(qrCodeMessage) {
document.getElementById('result').innerHTML = '<span class="result">' + qrCodeMessage + '</span>';
}
 
function onScanError(errorMessage) {
}
 
var html5QrcodeScanner = new Html5QrcodeScanner(
"reader", { fps: 10, qrbox: 500 }
);
html5QrcodeScanner.render(onScanSuccess, onScanError);
*/

</script>